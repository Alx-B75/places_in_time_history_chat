<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Admin · Figure Edit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/static/pit-favicon-mark.ico" />
  <link rel="stylesheet" href="/static/style.css?v=brand-9" />
  <style>
    body { background: linear-gradient(180deg, #0b1220, #0f172a 30%, #0b0f1a); color: #e5e7eb; }
    .container { max-width: 1200px; margin: 24px auto; padding: 0 16px; }
    .grid { display: grid; grid-template-columns: 1.1fr .9fr; gap: 16px; }
    .card { background: linear-gradient(180deg, #111827, #1f2937); border:1px solid #273549; border-radius: 16px; padding: 16px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .row .full { grid-column: 1 / -1; }
    label { display:block; font-size:12px; color:#94a3b8; margin-bottom:6px; }
    input, textarea { width:100%; background:#0b1220; border:1px solid #273549; color:#e5e7eb; border-radius:10px; padding:10px 12px; font-size:14px; }
    textarea { min-height: 120px; }
    .btn { border: 1px solid #273549; background: #0e1526; color:#e5e7eb; border-radius:10px; padding:10px 14px; font-weight:600; cursor:pointer; }
    .btn:hover { border-color:#60a5fa; }
    .btn.primary { background: linear-gradient(180deg, #1a2376, #1e40af); }
    .btn.success { background: linear-gradient(180deg, #0b5f3e, #065f46); }
    .btn.danger { background: linear-gradient(180deg, #7f1d1d, #991b1b); }
    .muted { color:#94a3b8; font-size:12px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border-bottom: 1px solid #273549; padding: 10px 8px; font-size: 14px; vertical-align: top; }
    th { text-align: left; color: #94a3b8; }
    .toolbar { display:flex; gap:8px; align-items:center; justify-content: space-between; margin-bottom: 12px; }
    .right { text-align: right; }
    .imgpreview { width: 100%; max-width: 320px; border-radius: 10px; border:1px solid #273549; }
    .pill { display:inline-block; padding: 4px 8px; border: 1px solid #273549; border-radius: 999px; font-size:12px; color:#94a3b8; }
  </style>
</head>
<body>
  <div class="container">
    <div class="toolbar">
      <div>
        <a class="btn" href="/admin/figures-ui">← Back to list</a>
        <span id="pageTitle" class="pill">Loading…</span>
      </div>
      <div class="right">
        <button id="saveBtn" class="btn success">Save Figure</button>
        <button id="deleteBtn" class="btn danger">Delete Figure</button>
      </div>
    </div>

    <div class="grid">
      <!-- Figure fields -->
      <div class="card">
        <h2>Figure</h2>
        <div class="row">
          <div>
            <label>Name</label>
            <input id="name" type="text" />
          </div>
          <div>
            <label>Slug</label>
            <input id="slug" type="text" />
          </div>
          <div>
            <label>Era</label>
            <input id="era" type="text" />
          </div>
          <div>
            <label>Image URL</label>
            <input id="image_url" type="text" />
          </div>
          <div class="full">
            <label>Short Summary</label>
            <textarea id="short_summary"></textarea>
          </div>
          <div class="full">
            <label>Long Bio</label>
            <textarea id="long_bio"></textarea>
          </div>
          <div class="full">
            <label>Quote</label>
            <textarea id="quote"></textarea>
          </div>
        </div>
        <div class="muted" id="figStatus">Waiting…</div>
      </div>

      <!-- Preview + RAG -->
      <div class="card">
        <h2>Preview</h2>
        <img id="previewImg" class="imgpreview" src="" alt="" onerror="this.style.display='none'"/>
        <p class="muted" id="previewSummary"></p>

        <h2 style="margin-top:12px;">RAG Sources</h2>
        <div class="toolbar">
          <div>
            <button class="btn" id="ragRefresh">Refresh</button>
            <button class="btn primary" id="ragAdd">Add Source</button>
          </div>
          <span class="muted" id="ragStatus">Waiting…</span>
        </div>
        <table>
          <thead><tr><th>ID</th><th>Name</th><th>Type</th><th>URL</th><th>Actions</th></tr></thead>
          <tbody id="ragBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script src="/static/admin_figure_edit.js?v=figedit-1"></script>
</body>
</html>
